### –ì–∞–π–¥ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–æ–¥—É–ª—è `BaseEntityStorage`

–ú–æ–¥—É–ª—å `BaseEntityStorage` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–Ω–∏–≥–∞–º–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ç.–¥.) —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∏—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è, –∑–∞–≥—Ä—É–∑–∫–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è. –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON, –∞ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏. –í —ç—Ç–æ–º –≥–∞–π–¥–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏.

---

## 1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è**
–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥—É–ª–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ —Ä–∞–∑–¥–µ–ª `uses` –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

```pascal
uses
  BaseEntityStorage;
```

---

## 2. **–°–æ–∑–¥–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏**
–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥—É–ª–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –≤–∞—à—É —Å—É—â–Ω–æ—Å—Ç—å. –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω –æ—Ç `TBaseEntity`.

### –ü—Ä–∏–º–µ—Ä:
```pascal
type
  TBook = class(TBaseEntity)
  private
    FAuthor: string;
    FYear: Integer;
  public
    property Author: string read FAuthor write FAuthor;
    property Year: Integer read FYear write FYear;
  end;
```

---

## 3. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**
–î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä `TBaseEntityStorage`, —É–∫–∞–∑–∞–≤ –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ, –≥–¥–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ, –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

### –ü—Ä–∏–º–µ—Ä:
```pascal
var
  BookStorage: TBaseEntityStorage<TBook>;
begin
  BookStorage := TBaseEntityStorage<TBook>.Create('C:\Data\Books', 100);
  try
    // –†–∞–±–æ—Ç–∞ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º
  finally
    BookStorage.Free;
  end;
end;
```

---

## 4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏**
–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `CreateEntity`. –ú–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å—É—â–Ω–æ—Å—Ç–∏.

### –ü—Ä–∏–º–µ—Ä:
```pascal
var
  NewBook: TBook;
  BookID: Integer;
begin
  NewBook := TBook.Create;
  try
    NewBook.Name := '–í–æ–π–Ω–∞ –∏ –º–∏—Ä';
    NewBook.Author := '–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π';
    NewBook.Year := 1869;
    BookID := BookStorage.CreateEntity(NewBook);
    WriteLn('–ö–Ω–∏–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å ID: ', BookID);
  finally
    NewBook.Free;
  end;
end;
```

---

## 5. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ –ø–æ ID**
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–∏ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `ReadEntity`, –ø–µ—Ä–µ–¥–∞–≤ ID —Å—É—â–Ω–æ—Å—Ç–∏.

### –ü—Ä–∏–º–µ—Ä:
```pascal
var
  Book: TBook;
begin
  Book := BookStorage.ReadEntity(1); // –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥—É —Å ID = 1
  try
    WriteLn('–ù–∞–∑–≤–∞–Ω–∏–µ: ', Book.Name);
    WriteLn('–ê–≤—Ç–æ—Ä: ', Book.Author);
    WriteLn('–ì–æ–¥: ', Book.Year);
  finally
    Book.Free;
  end;
end;
```

---

## 6. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏**
–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `UpdateEntity`. –ò–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ –∫—ç—à–µ.

### –ü—Ä–∏–º–µ—Ä:
```pascal
var
  Book: TBook;
begin
  Book := BookStorage.ReadEntity(1); // –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥—É —Å ID = 1
  try
    Book.Year := 1870; // –û–±–Ω–æ–≤–ª—è–µ–º –≥–æ–¥ –∏–∑–¥–∞–Ω–∏—è
    BookStorage.UpdateEntity(Book); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    WriteLn('–ö–Ω–∏–≥–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞.');
  finally
    Book.Free;
  end;
end;
```

---

## 7. **–£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏**
–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `DeleteEntity`, –ø–µ—Ä–µ–¥–∞–≤ ID —Å—É—â–Ω–æ—Å—Ç–∏.

### –ü—Ä–∏–º–µ—Ä:
```pascal
begin
  BookStorage.DeleteEntity(1); // –£–¥–∞–ª—è–µ–º –∫–Ω–∏–≥—É —Å ID = 1
  WriteLn('–ö–Ω–∏–≥–∞ —É–¥–∞–ª–µ–Ω–∞.');
end;
```

---

## 8. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π**
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –∫—ç—à–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `GetAllEntities`.

### –ü—Ä–∏–º–µ—Ä:
```pascal
var
  Books: TObjectList<TBook>;
  Book: TBook;
begin
  Books := BookStorage.GetAllEntities;
  try
    for Book in Books do
    begin
      WriteLn('ID: ', Book.ID, ', –ù–∞–∑–≤–∞–Ω–∏–µ: ', Book.Name, ', –ê–≤—Ç–æ—Ä: ', Book.Author);
    end;
  finally
    Books.Free;
  end;
end;
```

---

## 9. **–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ JSON**
–ú–æ–¥—É–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π –≤ JSON –∏ –æ–±—Ä–∞—Ç–Ω–æ. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—á–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π –ø–æ —Å–µ—Ç–∏.

### –ü—Ä–∏–º–µ—Ä:
```pascal
var
  Book: TBook;
  JSONString: string;
begin
  Book := BookStorage.ReadEntity(1); // –ü–æ–ª—É—á–∞–µ–º –∫–Ω–∏–≥—É —Å ID = 1
  try
    JSONString := BookStorage.ToJSON(Book); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ JSON
    WriteLn('JSON: ', JSONString);

    // –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ JSON
    BookStorage.FromJSON(Book, JSONString);
  finally
    Book.Free;
  end;
end;
```

---

## 10. **–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞**
–ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (`FMaxCacheSize`). –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à, –≤—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏–∑ –∫—ç—à–∞:

```pascal
BookStorage.FCache.Clear;
```

---

## 11. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –º–æ–¥—É–ª–µ–º –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –æ—à–∏–±–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∞–π–ª–∞ —Å—É—â–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —á—Ç–µ–Ω–∏–µ–º/–∑–∞–ø–∏—Å—å—é JSON. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–ª–æ–∫–∏ `try..except` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π.

### –ü—Ä–∏–º–µ—Ä:
```pascal
try
  Book := BookStorage.ReadEntity(999); // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—É—â–Ω–æ—Å—Ç—å
except
  on E: Exception do
    WriteLn('–û—à–∏–±–∫–∞: ', E.Message);
end;
```

---

## 12. **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**
–ú–æ–¥—É–ª—å `BaseEntityStorage` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç—è–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è. –û–Ω –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö. –°–ª–µ–¥—É—è —ç—Ç–æ–º—É –≥–∞–π–¥—É, –≤—ã —Å–º–æ–∂–µ—Ç–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –≤ —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –º–æ–¥—É–ª—è –∏–ª–∏ –∫ –∞–≤—Ç–æ—Ä—É (–ë–µ–≥—Ç–∏–Ω –ö.–í. (–û–≥–Ω–µ—è—Ä)). –£–¥–∞—á–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ! üöÄ